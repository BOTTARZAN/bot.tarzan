<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>طلب رمز الاقتران</title>
<style>
  body { font-family: Arial; background: #0f2027; color: #fff; display: flex; justify-content: center; align-items: center; height: 100vh; }
  .box { background: #1e293b; padding: 20px; border-radius: 10px; text-align: center; width: 300px; }
  input, button { width: 100%; margin: 10px 0; padding: 10px; border-radius: 5px; border: none; font-size: 16px; }
  button { background: #38bdf8; color: white; cursor: pointer; }
  #code { margin-top: 15px; font-size: 20px; font-weight: bold; }
  .copy { cursor: pointer; background: #4ade80; margin-top: 10px; }
</style>
</head>
<body>
<div class="box">
  <h2>أدخل رقمك</h2>
  <input type="text" id="phone" placeholder="+966500000000">
  <button onclick="getCode()">احصل على الرمز</button>
  <div id="code"></div>
  <button id="copyBtn" class="copy" style="display:none;" onclick="copyCode()">نسخ الرمز</button>
</div>
<script>
async function getCode() {
  const phone = document.getElementById('phone').value;
  const res = await fetch('/create-session', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ sessionId: 'tarzan', mode: 'pairing', phone })
  });
  const data = await res.json();
  if (data.pairingCode) {
    document.getElementById('code').innerText = `الرمز: ${data.pairingCode}`;
    document.getElementById('copyBtn').style.display = 'block';
  } else {
    document.getElementById('code').innerText = 'حدث خطأ!';
  }
}

function copyCode() {
  const text = document.getElementById('code').innerText.replace('الرمز: ', '');
  navigator.clipboard.writeText(text);
  alert('تم نسخ الرمز!');
}
</script>
</body>
</html>
